<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <title>Gallery Γάμου | Κουτρουλής</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="gallery.css" />
</head>
<body>
  <header class="g-header">
    <a class="g-back" href="index.html" aria-label="Επιστροφή στην αρχική">← Αρχική</a>
    <h1>Gallery Γάμου</h1>
  </header>

  <main>
    <div id="gallery" class="g-grid" aria-live="polite"></div>
  </main>

  <script>
    // ============== ΡΥΘΜΙΣΕΙΣ ==============
    // Βάση φακέλου για τις εικόνες του γάμου
    const basePath = "wedding/";

  
  const prefix = "w";
  const exts = ["jpg", "jpeg", "png"];
  const maxImages = 40;

  // ---- helper ----
  const exists = (url) =>
    new Promise((resolve) => {
      const img = new Image();
      const done = (ok) => resolve(ok ? url : null);
      img.onload = () => done(true);
      img.onerror = () => done(false);
      img.src = url + "?t=" + Date.now();
    });

  (async () => {
    const allCandidates = [];
    for (let i = 1; i <= maxImages; i++) {
      for (const ext of exts) {
        allCandidates.push(`${basePath}${prefix}${i}.${ext}`);
      }
    }

    // κάνε ταυτόχρονα τις αιτήσεις, αλλά με περιορισμό batch για αποδοτικότητα
    const concurrency = 10;
    const found = [];

    for (let i = 0; i < allCandidates.length; i += concurrency) {
      const batch = allCandidates.slice(i, i + concurrency);
      const results = await Promise.all(batch.map(exists));
      for (const url of results.filter(Boolean)) found.push(url);
    }

    // Αν δεν βρέθηκε τίποτα
    if (found.length === 0) {
      console.warn("Δεν βρέθηκαν εικόνες στον φάκελο wedding");
      window.IMAGES = [];
    } else {
      console.log(`Βρέθηκαν ${found.length} εικόνες.`);
      window.IMAGES = found;
    }

    // Ενημερώνουμε το gallery.js ότι είναι έτοιμες
    document.dispatchEvent(new Event("IMAGES_READY"));
  })();


  </script>

  <script defer src="gallery.js"></script>
</body>
</html>
